<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Precios Bs y USD</title>
    <!-- Incluir Tailwind CSS para el estilo -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilo para la fuente Inter, que da un aspecto limpio y moderno */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
        }
        /* Estilos específicos para la tabla y el input */
        .header-bg {
            background-color: #2c3e50; /* Azul oscuro */
            color: white;
        }
        .text-bs {
            color: #16a085; /* Verde menta para Bolívares */
            font-weight: 600;
        }
        .text-usd {
            color: #f39c12; /* Naranja para Dólares (Ahora el precio base) */
            font-weight: 600;
        }
        .cursor-pointer:hover {
            background-color: #e5e7eb; /* Gris claro al pasar el ratón por el encabezado */
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-4xl mx-auto bg-white shadow-xl rounded-2xl overflow-hidden">
        
        <!-- Encabezado de la Aplicación -->
        <header class="p-6 header-bg">
            <h1 class="text-3xl font-bold mb-1">Lista de Precios Tipo Hoja de Cálculo</h1>
            <p class="text-gray-300">Precios base fijos en USD. Los precios en Bs. se actualizan con la tasa.</p>
        </header>

        <!-- Conversor de Tasa de Cambio -->
        <div class="p-6 border-b border-gray-200 bg-gray-50">
            <label for="tasa-cambio" class="block text-lg font-semibold text-gray-700 mb-2">
                Tasa de Cambio Actual: 1 USD = ? Bs.
            </label>
            <div class="flex items-center space-x-3">
                <p class="text-xl font-bold text-gray-800">1 USD =</p>
                <input
                    type="number"
                    id="tasa-cambio"
                    value="254.87"
                    step="0.01"
                    min="1"
                    oninput="sortAndRender()"
                    class="flex-grow p-3 border-2 border-yellow-500 rounded-lg focus:ring-yellow-500 focus:border-yellow-500 text-xl font-mono text-center shadow-inner"
                    placeholder="Ej: 254.87"
                >
                <p class="text-xl font-bold text-bs">Bs.</p>
            </div>
            <p class="mt-2 text-sm text-gray-500">
                Modifica el valor para recalcular automáticamente todos los precios en Bs.
            </p>
        </div>

        <!-- Tabla de Precios -->
        <div class="p-6 overflow-x-auto">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Productos y Precios</h2>
            <table class="min-w-full divide-y divide-gray-200 rounded-xl shadow-md overflow-hidden">
                <thead class="bg-gray-100">
                    <tr>
                        <th onclick="sortAndRender('nombre')" data-sort-key="nombre" class="cursor-pointer px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hover:bg-gray-200 transition duration-150 ease-in-out">
                            Producto <span class="sort-indicator text-xs"></span>
                        </th>
                        <th onclick="sortAndRender('cantidad')" data-sort-key="cantidad" class="cursor-pointer px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hover:bg-gray-200 transition duration-150 ease-in-out">
                            Peso/Cant. <span class="sort-indicator text-xs"></span>
                        </th>
                        <th onclick="sortAndRender('precioUsd')" data-sort-key="precioUsd" class="cursor-pointer px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider text-usd hover:bg-gray-200 transition duration-150 ease-in-out">
                            Precio Base (USD) <span class="sort-indicator text-xs"></span>
                        </th>
                        <th onclick="sortAndRender('precioBs')" data-sort-key="precioBs" class="cursor-pointer px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider text-bs hover:bg-gray-200 transition duration-150 ease-in-out">
                            Precio (Bs.) <span class="sort-indicator text-xs"></span>
                        </th>
                    </tr>
                </thead>
                <tbody id="tabla-precios" class="bg-white divide-y divide-gray-200">
                    <!-- Las filas de productos se inyectarán aquí por JavaScript -->
                </tbody>
            </table>
        </div>

    </div>

    <script>
        // Los datos de los productos ahora están fijos en USD, calculados con la tasa inicial de 254.87 Bs/$.
        // NOTA: La propiedad ha sido renombrada de 'precioBs' a 'precioUsd'.
        const productos = [
            // Carnes
            { categoria: 'Carnes', nombre: 'Bistec', cantidad: '1 kg', precioUsd: 9.61 },
            { categoria: 'Carnes', nombre: 'Guisar', cantidad: '1 kg', precioUsd: 8.83 },
            { categoria: 'Carnes', nombre: 'Mechar', cantidad: '1 kg', precioUsd: 8.83 },
            { categoria: 'Carnes', nombre: 'Molida', cantidad: '1 kg', precioUsd: 6.28 },
            { categoria: 'Carnes', nombre: 'Costilla', cantidad: '1 kg', precioUsd: 5.89 },
            { categoria: 'Carnes', nombre: 'Lagarto %', cantidad: '1 kg', precioUsd: 5.85 },
            { categoria: 'Carnes', nombre: 'Cochino Pulpo', cantidad: '1 kg', precioUsd: 9.81 },
            { categoria: 'Carnes', nombre: 'Chuleta', cantidad: '1 kg', precioUsd: 7.85 },

            // Pollo
            { categoria: 'Pollo', nombre: 'Pollo Entero', cantidad: '1 kg', precioUsd: 3.34 },
            { categoria: 'Pollo', nombre: 'Pollo Picado', cantidad: '1 kg', precioUsd: 3.53 },
            { categoria: 'Pollo', nombre: 'Muslo', cantidad: '1 kg', precioUsd: 6.87 },
            { categoria: 'Pollo', nombre: 'Filet de Pechuga', cantidad: '1 kg', precioUsd: 4.51 },
            
            // Pollo (Porciones de 1/2 kg)
            { categoria: 'Pollo', nombre: 'Ala', cantidad: '1/2 kg', precioUsd: 2.71 },
            { categoria: 'Pollo', nombre: 'Pata', cantidad: '1/2 kg', precioUsd: 2.71 },
            { categoria: 'Pollo', nombre: 'Molleja', cantidad: '1/2 kg', precioUsd: 3.14 },
            { categoria: 'Pollo', nombre: 'Hígado de Pollo', cantidad: '1/2 kg', precioUsd: 2.71 },
            { categoria: 'Pollo', nombre: 'Carapacho', cantidad: '1/2 kg', precioUsd: 1.57 },
            
            // Combos (Precios Adicionales de 0.4kg/0.5kg)
            { categoria: 'Combos', nombre: 'Bistec (0.4 kg)', cantidad: '0.4 kg', precioUsd: 3.85 },
            { categoria: 'Combos', nombre: 'Guisar (0.4 kg)', cantidad: '0.4 kg', precioUsd: 3.53 },
            { categoria: 'Combos', nombre: 'Mechar (0.4 kg)', cantidad: '0.4 kg', precioUsd: 3.53 },
            { categoria: 'Combos', nombre: 'Molida (0.4 kg)', cantidad: '0.4 kg', precioUsd: 2.51 },
            { categoria: 'Combos', nombre: 'Pollo Picado', cantidad: '1/2 kg', precioUsd: 1.77 },
            { categoria: 'Combos', nombre: 'Costilla', cantidad: '1/2 kg', precioUsd: 2.94 },
            { categoria: 'Combos', nombre: 'Chuleta', cantidad: '1/2 kg', precioUsd: 3.92 },
        ];

        let currentSortKey = 'nombre'; // Ordena por nombre por defecto
        let sortDirection = 'asc';     // Dirección ascendente por defecto

        /**
         * Ordena la lista de productos por la clave dada y luego renderiza la tabla.
         * Esta función se llama al cambiar la tasa de cambio O al hacer clic en un encabezado.
         * @param {string} [sortByKey] - La clave de la propiedad por la que ordenar ('nombre', 'cantidad', 'precioUsd', 'precioBs').
         */
        function sortAndRender(sortByKey) {
            const tasaInput = document.getElementById('tasa-cambio');
            const tablaBody = document.getElementById('tabla-precios');
            
            tablaBody.innerHTML = ''; // Limpia el contenido anterior

            // --- 1. Obtener Tasa de Cambio ---
            let tasaCambio = parseFloat(tasaInput.value);
            if (isNaN(tasaCambio) || tasaCambio <= 0) {
                tasaCambio = 254.87; 
                tasaInput.classList.add('border-red-500');
            } else {
                 tasaInput.classList.remove('border-red-500');
            }

            // --- 2. Preparar el Ordenamiento ---
            // Si la función se llama sin una clave de ordenamiento, significa que solo se actualizó la tasa de cambio.
            if (sortByKey) {
                if (currentSortKey === sortByKey) {
                    // Cambiar dirección si se hace clic en la misma columna
                    sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
                } else {
                    // Nueva columna, reiniciar a ascendente
                    currentSortKey = sortByKey;
                    sortDirection = 'asc';
                }
            }

            // --- 3. Ordenar el Array de Productos ---
            productos.sort((a, b) => {
                let aValue = a[currentSortKey];
                let bValue = b[currentSortKey];
                const isUsdNumeric = currentSortKey === 'precioUsd';
                const isBsNumeric = currentSortKey === 'precioBs';

                // Si la clave de ordenamiento es 'precioBs', hay que calcular el valor
                if (isBsNumeric) {
                    // Cálculo de precio Bs: Precio USD * Tasa de Cambio
                    aValue = a.precioUsd * tasaCambio;
                    bValue = b.precioUsd * tasaCambio;
                }

                let comparison = 0;
                if (isUsdNumeric || isBsNumeric) {
                    comparison = aValue - bValue;
                } else {
                    // Ordenamiento de cadenas (case-insensitive)
                    const aStr = String(aValue).toLowerCase();
                    const bStr = String(bValue).toLowerCase();
                    if (aStr < bStr) comparison = -1;
                    if (aStr > bStr) comparison = 1;
                }

                return sortDirection === 'asc' ? comparison : -comparison;
            });

            // --- 4. Renderizar Filas y Actualizar Indicadores ---
            
            // Actualiza los indicadores de ordenamiento en los encabezados
            document.querySelectorAll('th[data-sort-key]').forEach(th => {
                const key = th.getAttribute('data-sort-key');
                let indicator = th.querySelector('.sort-indicator');
                if (key === currentSortKey) {
                    indicator.textContent = sortDirection === 'asc' ? ' ▲' : ' ▼';
                } else {
                    indicator.textContent = '';
                }
            });

            // Itera sobre la lista de productos (ya ordenada) y crea las filas de la tabla
            productos.forEach((producto, index) => {
                // Calcula el precio en Bs. usando la nueva tasa
                const precioBsCalculado = (producto.precioUsd * tasaCambio);
                
                const rowClass = index % 2 === 0 ? 'bg-white' : 'bg-gray-50';

                // Importante: Se elimina el sufijo "Bs." del campo para que solo quede el valor numérico formateado.
                const newRow = `
                    <tr class="${rowClass} hover:bg-yellow-100 transition duration-150 ease-in-out">
                        <td class="px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900">${producto.nombre}</td>
                        <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-500">${producto.cantidad}</td>
                        <td class="px-3 py-2 whitespace-nowrap text-sm text-right text-usd">$ ${producto.precioUsd.toFixed(2)}</td>
                        <td class="px-3 py-2 whitespace-nowrap text-sm text-right text-bs">${precioBsCalculado.toLocaleString('es-VE', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</td>
                    </tr>
                `;

                tablaBody.insertAdjacentHTML('beforeend', newRow);
            });
        }

        // Ejecuta la función al cargar la página para mostrar los resultados iniciales y el orden por defecto
        window.onload = sortAndRender;
    </script>

</body>
</html> 
